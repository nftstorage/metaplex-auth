<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@nftstorage/metaplex-auth</title><meta name="description" content="Documentation for @nftstorage/metaplex-auth"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@nftstorage/metaplex-auth</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@nftstorage/metaplex-auth</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Namespaces</h3><ul class="tsd-index-list"><li class="tsd-kind-namespace"><a href="modules/_internal_.html" class="tsd-kind-icon">&lt;internal&gt;</a></li></ul></section><section class="tsd-index-section "><h3>Classes</h3><ul class="tsd-index-list"><li class="tsd-kind-class"><a href="classes/NFTStorageMetaplexor.html" class="tsd-kind-icon">NFTStorage<wbr/>Metaplexor</a></li><li class="tsd-kind-class"><a href="classes/ValidationError.html" class="tsd-kind-icon">Validation<wbr/>Error</a></li></ul></section><section class="tsd-index-section "><h3>Interfaces</h3><ul class="tsd-index-list"><li class="tsd-kind-interface"><a href="interfaces/Attribute.html" class="tsd-kind-icon">Attribute</a></li><li class="tsd-kind-interface"><a href="interfaces/AuthContext.html" class="tsd-kind-icon">Auth<wbr/>Context</a></li><li class="tsd-kind-interface"><a href="interfaces/CollectionInfo.html" class="tsd-kind-icon">Collection<wbr/>Info</a></li><li class="tsd-kind-interface"><a href="interfaces/CreatorInfo.html" class="tsd-kind-icon">Creator<wbr/>Info</a></li><li class="tsd-kind-interface"><a href="interfaces/FileDescription.html" class="tsd-kind-icon">File<wbr/>Description</a></li><li class="tsd-kind-interface"><a href="interfaces/MetaplexMetadata.html" class="tsd-kind-icon">Metaplex<wbr/>Metadata</a></li><li class="tsd-kind-interface"><a href="interfaces/PackagedNFT.html" class="tsd-kind-icon">PackagedNFT</a></li><li class="tsd-kind-interface"><a href="interfaces/RequestContext.html" class="tsd-kind-icon">Request<wbr/>Context</a></li><li class="tsd-kind-interface"><a href="interfaces/StoreNFTResult.html" class="tsd-kind-icon">StoreNFTResult</a></li></ul></section><section class="tsd-index-section "><h3>Type aliases</h3><ul class="tsd-index-list"><li class="tsd-kind-type-alias"><a href="modules.html#EncodedCar" class="tsd-kind-icon">Encoded<wbr/>Car</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ServiceContext" class="tsd-kind-icon">Service<wbr/>Context</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Signer" class="tsd-kind-icon">Signer</a></li><li class="tsd-kind-type-alias"><a href="modules.html#SolanaCluster" class="tsd-kind-icon">Solana<wbr/>Cluster</a></li></ul></section><section class="tsd-index-section "><h3>Variables</h3><ul class="tsd-index-list"><li class="tsd-kind-variable"><a href="modules.html#TagChain" class="tsd-kind-icon">Tag<wbr/>Chain</a></li><li class="tsd-kind-variable"><a href="modules.html#TagMintingAgent" class="tsd-kind-icon">Tag<wbr/>Minting<wbr/>Agent</a></li><li class="tsd-kind-variable"><a href="modules.html#TagMintingAgentVersion" class="tsd-kind-icon">Tag<wbr/>Minting<wbr/>Agent<wbr/>Version</a></li><li class="tsd-kind-variable"><a href="modules.html#TagSolanaCluster" class="tsd-kind-icon">Tag<wbr/>Solana<wbr/>Cluster</a></li><li class="tsd-kind-variable"><a href="modules.html#metadataSchema" class="tsd-kind-icon">metadata<wbr/>Schema</a></li><li class="tsd-kind-variable"><a href="modules.html#validateMetadata" class="tsd-kind-icon">validate<wbr/>Metadata</a></li></ul></section><section class="tsd-index-section "><h3>Functions</h3><ul class="tsd-index-list"><li class="tsd-kind-function"><a href="modules.html#MetaplexAuthWithSecretKey" class="tsd-kind-icon">Metaplex<wbr/>Auth<wbr/>With<wbr/>Secret<wbr/>Key</a></li><li class="tsd-kind-function"><a href="modules.html#MetaplexAuthWithSigner" class="tsd-kind-icon">Metaplex<wbr/>Auth<wbr/>With<wbr/>Signer</a></li><li class="tsd-kind-function"><a href="modules.html#ensureValidMetadata" class="tsd-kind-icon">ensure<wbr/>Valid<wbr/>Metadata</a></li><li class="tsd-kind-function"><a href="modules.html#keyDID" class="tsd-kind-icon">keyDID</a></li><li class="tsd-kind-function"><a href="modules.html#loadNFTFromFilesystem" class="tsd-kind-icon">loadNFTFrom<wbr/>Filesystem</a></li><li class="tsd-kind-function"><a href="modules.html#makeMetaplexUploadToken" class="tsd-kind-icon">make<wbr/>Metaplex<wbr/>Upload<wbr/>Token</a></li><li class="tsd-kind-function"><a href="modules.html#prepareMetaplexNFT" class="tsd-kind-icon">prepare<wbr/>MetaplexNFT</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Type aliases</h2><section class="tsd-panel tsd-member tsd-kind-type-alias"><a id="EncodedCar" class="tsd-anchor"></a><h3>Encoded<wbr/>Car</h3><div class="tsd-signature tsd-kind-icon">Encoded<wbr/>Car<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">{ </span>car<span class="tsd-signature-symbol">: </span><a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#CarReader-1" class="tsd-signature-type" data-tsd-kind="Type alias">CarReader</a><span class="tsd-signature-symbol">; </span>cid<span class="tsd-signature-symbol">: </span><a href="classes/_internal_.CID.html" class="tsd-signature-type" data-tsd-kind="Class">CID</a><span class="tsd-signature-symbol"> }</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/nft/prepare.ts#L11">src/nft/prepare.ts:11</a></li></ul></aside><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5>car<span class="tsd-signature-symbol">: </span><a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#CarReader-1" class="tsd-signature-type" data-tsd-kind="Type alias">CarReader</a></h5></li><li class="tsd-parameter"><h5>cid<span class="tsd-signature-symbol">: </span><a href="classes/_internal_.CID.html" class="tsd-signature-type" data-tsd-kind="Class">CID</a></h5></li></ul></div></section><section class="tsd-panel tsd-member tsd-kind-type-alias"><a id="ServiceContext" class="tsd-anchor"></a><h3>Service<wbr/>Context</h3><div class="tsd-signature tsd-kind-icon">Service<wbr/>Context<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">{ </span>auth<span class="tsd-signature-symbol">: </span><a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a><span class="tsd-signature-symbol">; </span>endpoint<span class="tsd-signature-symbol">?: </span><a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#URL-1" class="tsd-signature-type" data-tsd-kind="Variable">URL</a><span class="tsd-signature-symbol"> }</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/upload.ts#L22">src/upload.ts:22</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Information required to reach the NFT.Storage service and prepare upload tokens.</p>
</div></div><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5>auth<span class="tsd-signature-symbol">: </span><a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a></h5></li><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> endpoint<span class="tsd-signature-symbol">?: </span><a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#URL-1" class="tsd-signature-type" data-tsd-kind="Variable">URL</a></h5></li></ul></div></section><section class="tsd-panel tsd-member tsd-kind-type-alias"><a id="Signer" class="tsd-anchor"></a><h3>Signer</h3><div class="tsd-signature tsd-kind-icon">Signer<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">(</span>message<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Uint8Array</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol"> =&gt; </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">Uint8Array</span><span class="tsd-signature-symbol">&gt;</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L68">src/auth.ts:68</a></li></ul></aside><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter-signature"><ul class="tsd-signatures tsd-kind-type-literal tsd-parent-kind-type-alias"><li class="tsd-signature tsd-kind-icon"><span class="tsd-signature-symbol">(</span>message<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Uint8Array</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">Uint8Array</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>message: <span class="tsd-signature-type">Uint8Array</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">Uint8Array</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></li></ul></div></section><section class="tsd-panel tsd-member tsd-kind-type-alias"><a id="SolanaCluster" class="tsd-anchor"></a><h3>Solana<wbr/>Cluster</h3><div class="tsd-signature tsd-kind-icon">Solana<wbr/>Cluster<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L52">src/auth.ts:52</a></li></ul></aside></section></section><section class="tsd-panel-group tsd-member-group "><h2>Variables</h2><section class="tsd-panel tsd-member tsd-kind-variable"><a id="TagChain" class="tsd-anchor"></a><h3>Tag<wbr/>Chain</h3><div class="tsd-signature tsd-kind-icon">Tag<wbr/>Chain<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">&quot;chain&quot;</span><span class="tsd-signature-symbol"> = &#39;chain&#39;</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L9">src/auth.ts:9</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Request tag indicating what blockchain will be used to mint. Currently, the value
will always be set to <code>&quot;solana&quot;</code> and cannot be overridden by the user.</p>
</div></div></section><section class="tsd-panel tsd-member tsd-kind-variable"><a id="TagMintingAgent" class="tsd-anchor"></a><h3>Tag<wbr/>Minting<wbr/>Agent</h3><div class="tsd-signature tsd-kind-icon">Tag<wbr/>Minting<wbr/>Agent<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">&quot;mintingAgent&quot;</span><span class="tsd-signature-symbol"> = &#39;mintingAgent&#39;</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L40">src/auth.ts:40</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Request tag indicating which &quot;user agent&quot; or tool is being used to prepare the upload. This should be
set to a string that includes the name of the tool or platform.</p>
</div><div><p>Projects using this library are free to choose their own value for this tag, however you should avoid
changing the name over time, unless the project itself changes names (for example, due to a community fork or re-branding).</p>
<p>For personal projects or individuals creating tools that are not affiliated with a public platform, please set the
value to a URL for your code repository. If your code is not yet public, please create a repository containing a
description of the project and links to its public-facing interface.</p>
<p>Examples of suitable values:</p>
<ul>
<li><code>&quot;metaplex/candy-machine-cli&quot;</code></li>
<li><code>&quot;metaplex/js-sdk&quot;</code></li>
<li><code>&quot;magiceden/mint-authority&quot;</code></li>
<li><code>&quot;https://github.com/samuelvanderwaal/metaboss&quot;</code></li>
</ul>
</div></div></section><section class="tsd-panel tsd-member tsd-kind-variable"><a id="TagMintingAgentVersion" class="tsd-anchor"></a><h3>Tag<wbr/>Minting<wbr/>Agent<wbr/>Version</h3><div class="tsd-signature tsd-kind-icon">Tag<wbr/>Minting<wbr/>Agent<wbr/>Version<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">&quot;agentVersion&quot;</span><span class="tsd-signature-symbol"> = &#39;agentVersion&#39;</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L46">src/auth.ts:46</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Optional request tag indicating which version of the &quot;minting agent&quot; was used to prepare the request.
This may contain arbitrary text, as each project may have their own versioning scheme.</p>
</div></div></section><section class="tsd-panel tsd-member tsd-kind-variable"><a id="TagSolanaCluster" class="tsd-anchor"></a><h3>Tag<wbr/>Solana<wbr/>Cluster</h3><div class="tsd-signature tsd-kind-icon">Tag<wbr/>Solana<wbr/>Cluster<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">&quot;solanaCluster&quot;</span><span class="tsd-signature-symbol"> = &#39;solanaCluster&#39;</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L19">src/auth.ts:19</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Request tag indicating which <a href="https://docs.solana.com/clusters">Solana cluster</a> will be
used to mint.</p>
</div><div><p>Currently this library will accept any string value, however it is strongly
recommended that you use one of these &quot;canonical&quot; values: <code>&quot;devnet&quot;</code>, <code>&quot;mainnet-beta&quot;</code>, <code>&quot;testnet&quot;</code>.
This may be enforced by the backend at a later date.</p>
</div></div></section><section class="tsd-panel tsd-member tsd-kind-variable"><a id="metadataSchema" class="tsd-anchor"></a><h3>metadata<wbr/>Schema</h3><div class="tsd-signature tsd-kind-icon">metadata<wbr/>Schema<span class="tsd-signature-symbol">:</span> <a href="modules/_internal_.html#JSONSchemaType" class="tsd-signature-type" data-tsd-kind="Type alias">JSONSchemaType</a><span class="tsd-signature-symbol">&lt;</span><a href="interfaces/MetaplexMetadata.html" class="tsd-signature-type" data-tsd-kind="Interface">MetaplexMetadata</a><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> = ...</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/metadata/schema.ts#L92">src/metadata/schema.ts:92</a></li></ul></aside></section><section class="tsd-panel tsd-member tsd-kind-variable"><a id="validateMetadata" class="tsd-anchor"></a><h3>validate<wbr/>Metadata</h3><div class="tsd-signature tsd-kind-icon">validate<wbr/>Metadata<span class="tsd-signature-symbol">:</span> <a href="interfaces/_internal_.ValidateFunction.html" class="tsd-signature-type" data-tsd-kind="Interface">ValidateFunction</a><span class="tsd-signature-symbol">&lt;</span><a href="interfaces/MetaplexMetadata.html" class="tsd-signature-type" data-tsd-kind="Interface">MetaplexMetadata</a><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> = ...</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/metadata/validate.ts#L13">src/metadata/validate.ts:13</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Validator function for Metaplex NFT metadata objects. Returns true if metadata is valid.</p>
</div><div><p>Can be used as a TypeScript type guard - if <code>validateMetadata(someObject)</code> returns <code>true</code>,
<code>someObject</code> can safely be treated as an instance of <a href="interfaces/MetaplexMetadata.html">MetaplexMetadata</a>.</p>
</div></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Functions</h2><section class="tsd-panel tsd-member tsd-kind-function"><a id="MetaplexAuthWithSecretKey" class="tsd-anchor"></a><h3>Metaplex<wbr/>Auth<wbr/>With<wbr/>Secret<wbr/>Key</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">Metaplex<wbr/>Auth<wbr/>With<wbr/>Secret<wbr/>Key<span class="tsd-signature-symbol">(</span>privkey<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Uint8Array</span>, opts<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">{ </span>agentVersion<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>mintingAgent<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>solanaCluster<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L104">src/auth.ts:104</a></li></ul></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>privkey: <span class="tsd-signature-type">Uint8Array</span></h5></li><li><h5>opts: <span class="tsd-signature-symbol">{ </span>agentVersion<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>mintingAgent<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>solanaCluster<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span></h5><ul class="tsd-parameters"><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> agent<wbr/>Version<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>minting<wbr/>Agent<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> solana<wbr/>Cluster<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span></h5></li></ul></li></ul><h4 class="tsd-returns-title">Returns <a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function"><a id="MetaplexAuthWithSigner" class="tsd-anchor"></a><h3>Metaplex<wbr/>Auth<wbr/>With<wbr/>Signer</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">Metaplex<wbr/>Auth<wbr/>With<wbr/>Signer<span class="tsd-signature-symbol">(</span>signMessage<span class="tsd-signature-symbol">: </span><a href="modules.html#Signer" class="tsd-signature-type" data-tsd-kind="Type alias">Signer</a>, publicKey<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Uint8Array</span>, opts<span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">{ </span>agentVersion<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>mintingAgent<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>solanaCluster<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L77">src/auth.ts:77</a></li></ul></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>signMessage: <a href="modules.html#Signer" class="tsd-signature-type" data-tsd-kind="Type alias">Signer</a></h5></li><li><h5>publicKey: <span class="tsd-signature-type">Uint8Array</span></h5></li><li><h5>opts: <span class="tsd-signature-symbol">{ </span>agentVersion<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>mintingAgent<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>solanaCluster<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> }</span></h5><ul class="tsd-parameters"><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> agent<wbr/>Version<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>minting<wbr/>Agent<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5><span class="tsd-flag ts-flagOptional">Optional</span> solana<wbr/>Cluster<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span></h5></li></ul></li></ul><h4 class="tsd-returns-title">Returns <a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function"><a id="ensureValidMetadata" class="tsd-anchor"></a><h3>ensure<wbr/>Valid<wbr/>Metadata</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">ensure<wbr/>Valid<wbr/>Metadata<span class="tsd-signature-symbol">(</span>m<span class="tsd-signature-symbol">: </span><a href="modules/_internal_.html#Record" class="tsd-signature-type" data-tsd-kind="Type alias">Record</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="interfaces/MetaplexMetadata.html" class="tsd-signature-type" data-tsd-kind="Interface">MetaplexMetadata</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/metadata/validate.ts#L22">src/metadata/validate.ts:22</a></li></ul></aside><div class="tsd-comment tsd-typography"><dl class="tsd-comment-tags"><dt>throws</dt><dd><p><a href="classes/ValidationError.html">ValidationError</a> if input is not valid metaplex metadata.</p>
</dd></dl></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>m: <a href="modules/_internal_.html#Record" class="tsd-signature-type" data-tsd-kind="Type alias">Record</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>a JS object that hopefully contains valid metaplex NFT metadata</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <a href="interfaces/MetaplexMetadata.html" class="tsd-signature-type" data-tsd-kind="Interface">MetaplexMetadata</a></h4><div><p>the input object as an instance of <a href="interfaces/MetaplexMetadata.html">MetaplexMetadata</a> if input
is valid.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function"><a id="keyDID" class="tsd-anchor"></a><h3>keyDID</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">keyDID<span class="tsd-signature-symbol">(</span>pubkey<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Uint8Array</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L153">src/auth.ts:153</a></li></ul></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>pubkey: <span class="tsd-signature-type">Uint8Array</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">string</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function"><a id="loadNFTFromFilesystem" class="tsd-anchor"></a><h3>loadNFTFrom<wbr/>Filesystem</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">loadNFTFrom<wbr/>Filesystem<span class="tsd-signature-symbol">(</span>metadataFilePath<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, imageFilePath<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="interfaces/PackagedNFT.html" class="tsd-signature-type" data-tsd-kind="Interface">PackagedNFT</a><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/nft/load.ts#L48">src/nft/load.ts:48</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Loads a Metaplex NFT from the filesystem, including metadata json, main image, and any
additional files referenced in the metadata.</p>
</div><div><p>Loads <a href="https://docs.metaplex.com/nft-standard">Metaplex NFT metadata JSON</a> from <code>metadataFilePath</code>,
using the image located at <code>imageFilePath</code>. If <code>imageFilePath</code> is not provided, attempts to find the image
in the following way:</p>
<ul>
<li>If the metadata JSON object&#39;s <code>image</code> field contains the path to a file
and the file exists, use it</li>
<li>Otherwise, take the filename of the metadata file (e.g. <code>1.json</code>)
and look for a file with the same basename and a <code>.png</code> extension (e.g. <code>1.png</code>).</li>
</ul>
<p>If no image file can be found, the returned promise will reject with an Error.</p>
<p>In addition to the <code>image</code> field, if the <code>animation_url</code> contains a valid file path,
the file will be uploaded to NFT.Storage, and <code>animation_url</code> will be set to an
IPFS HTTP gateway link to the content.</p>
<p>Entries in <code>properties.files</code> that contain valid file paths as their <code>uri</code> value will also be uploaded to
NFT.Storage, and each file will have two entries in the final metadata&#39;s <code>properties.files</code>
array. One entry contains an HTTP gateway URL as the <code>uri</code>, with the <code>cdn</code> field set to <code>true</code>, while the
other contains an <code>ipfs://</code> URI, with <code>cdn</code> set to <code>false</code>. This preserves the location-independent
&quot;canonical&quot; IPFS URI in the blockchain-linked record, while signalling to HTTP-only clients that they
can use the <code>cdn</code> variant.</p>
<p>All file paths contained in the metadata should be relative to the directory containing the metadata file.</p>
<p>Note that this function does NOT store anything with NFT.Storage. To store the returned <code>PackagedNFT</code> object,
see <a href="classes/NFTStorageMetaplexor.html#storePreparedNFT-1">NFTStorageMetaplexor.storePreparedNFT</a>, or use <a href="classes/NFTStorageMetaplexor.html#storeNFTFromFilesystem-1">NFTStorageMetaplexor.storeNFTFromFilesystem</a>,
which calls this function and stores the result.</p>
<p>This function is only available on node.js and will throw if invoked from a browser runtime.</p>
</div></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>metadataFilePath: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>path to a JSON file containing Metaplex NFT metadata</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> imageFilePath: <span class="tsd-signature-type">string</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>path to an image to be used as the primary <code>image</code> content for the NFT. If not provided,
the image will be located as described above.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="interfaces/PackagedNFT.html" class="tsd-signature-type" data-tsd-kind="Interface">PackagedNFT</a><span class="tsd-signature-symbol">&gt;</span></h4><div><p>on success, a <a href="interfaces/PackagedNFT.html">PackagedNFT</a> object containing the parsed metadata and the CAR data to upload
to NFT.Storage.</p>
</div></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function"><a id="makeMetaplexUploadToken" class="tsd-anchor"></a><h3>make<wbr/>Metaplex<wbr/>Upload<wbr/>Token</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">make<wbr/>Metaplex<wbr/>Upload<wbr/>Token<span class="tsd-signature-symbol">(</span>auth<span class="tsd-signature-symbol">: </span><a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a>, rootCID<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/auth.ts#L120">src/auth.ts:120</a></li></ul></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>auth: <a href="interfaces/AuthContext.html" class="tsd-signature-type" data-tsd-kind="Interface">AuthContext</a></h5></li><li><h5>rootCID: <span class="tsd-signature-type">string</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-function"><a id="prepareMetaplexNFT" class="tsd-anchor"></a><h3>prepare<wbr/>MetaplexNFT</h3><ul class="tsd-signatures tsd-kind-function"><li class="tsd-signature tsd-kind-icon">prepare<wbr/>MetaplexNFT<span class="tsd-signature-symbol">(</span>metadata<span class="tsd-signature-symbol">: </span><a href="modules/_internal_.html#Record" class="tsd-signature-type" data-tsd-kind="Type alias">Record</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span>, imageFile<span class="tsd-signature-symbol">: </span><a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#File-1" class="tsd-signature-type" data-tsd-kind="Variable">File</a>, <span class="tsd-signature-symbol">...</span>additionalAssetFiles<span class="tsd-signature-symbol">: </span><a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#File-1" class="tsd-signature-type" data-tsd-kind="Variable">File</a><span class="tsd-signature-symbol">[]</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="interfaces/PackagedNFT.html" class="tsd-signature-type" data-tsd-kind="Interface">PackagedNFT</a><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/nftstorage/metaplex-auth/blob/7a5f5cc/src/nft/prepare.ts#L55">src/nft/prepare.ts:55</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Encodes the given NFT metadata and asset files into CARs that can be uploaded to
NFT.Storage.</p>
</div><div><p>First, the <code>imageFile</code> and any <code>additionalAssetFiles</code> are packed into a CAR,
and the root CID of this &quot;asset CAR&quot; is used to create IPFS URIs and gateway
URLs for each file in the NFT bundle.</p>
<p>The input metadata is then modified:</p>
<ul>
<li>The <code>image</code> field is set to an HTTP gateway URL for the <code>imageFile</code></li>
<li>If <code>animation_url</code> contains a filename that matches the <code>name</code> of any
of the <code>additionalAssetFiles</code>, its value will be set to an HTTP gateway URL
for that file.</li>
<li>If any entries in <code>properties.files</code> have a <code>uri</code> that matches the <code>name</code>
of <code>imageFile</code> or any of the <code>additionalAssetFiles</code>, it will be replaced
by <em>two</em> entries in the output metadata. One will contain an <code>ipfs://</code> uri
with <code>cdn == false</code>, and the other will have an HTTP gateway URL, with
<code>cdn == true</code>.</li>
</ul>
<p>This updated metadata is then serialized and packed into a second car.
Both CARs are returned in a <a href="interfaces/PackagedNFT.html">PackagedNFT</a> object, which also contains
the updated metadata object and links to the metadata.</p>
<p>Note that this function does NOT store anything with NFT.Storage. The links
in the returned <a href="interfaces/PackagedNFT.html">PackagedNFT</a> will not resolve until the CARs have been
uploaded. Use <a href="classes/NFTStorageMetaplexor.html#storePreparedNFT-1">NFTStorageMetaplexor.storePreparedNFT</a> to upload.</p>
</div></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>metadata: <a href="modules/_internal_.html#Record" class="tsd-signature-type" data-tsd-kind="Type alias">Record</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">, </span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>a JS object containing (hopefully) valid Metaplex NFT metadata</p>
</div></div></li><li><h5>imageFile: <a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#File-1" class="tsd-signature-type" data-tsd-kind="Variable">File</a></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>a File object containing image data.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagRest">Rest</span> <span class="tsd-signature-symbol">...</span>additionalAssetFiles: <a href="modules/_internal_.html" class="tsd-signature-type" data-tsd-kind="Namespace">&lt;internal&gt;</a><span class="tsd-signature-symbol">.</span><a href="modules/_internal_.html#File-1" class="tsd-signature-type" data-tsd-kind="Variable">File</a><span class="tsd-signature-symbol">[]</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>any additional asset files (animations, higher resolution variants, etc)</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="interfaces/PackagedNFT.html" class="tsd-signature-type" data-tsd-kind="Interface">PackagedNFT</a><span class="tsd-signature-symbol">&gt;</span></h4><div></div></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li><li class=" tsd-kind-namespace"><a href="modules/_internal_.html">&lt;internal&gt;</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/NFTStorageMetaplexor.html" class="tsd-kind-icon">NFTStorage<wbr/>Metaplexor</a></li><li class="tsd-kind-class"><a href="classes/ValidationError.html" class="tsd-kind-icon">Validation<wbr/>Error</a></li><li class="tsd-kind-interface"><a href="interfaces/Attribute.html" class="tsd-kind-icon">Attribute</a></li><li class="tsd-kind-interface"><a href="interfaces/AuthContext.html" class="tsd-kind-icon">Auth<wbr/>Context</a></li><li class="tsd-kind-interface"><a href="interfaces/CollectionInfo.html" class="tsd-kind-icon">Collection<wbr/>Info</a></li><li class="tsd-kind-interface"><a href="interfaces/CreatorInfo.html" class="tsd-kind-icon">Creator<wbr/>Info</a></li><li class="tsd-kind-interface"><a href="interfaces/FileDescription.html" class="tsd-kind-icon">File<wbr/>Description</a></li><li class="tsd-kind-interface"><a href="interfaces/MetaplexMetadata.html" class="tsd-kind-icon">Metaplex<wbr/>Metadata</a></li><li class="tsd-kind-interface"><a href="interfaces/PackagedNFT.html" class="tsd-kind-icon">PackagedNFT</a></li><li class="tsd-kind-interface"><a href="interfaces/RequestContext.html" class="tsd-kind-icon">Request<wbr/>Context</a></li><li class="tsd-kind-interface"><a href="interfaces/StoreNFTResult.html" class="tsd-kind-icon">StoreNFTResult</a></li><li class="tsd-kind-type-alias"><a href="modules.html#EncodedCar" class="tsd-kind-icon">Encoded<wbr/>Car</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ServiceContext" class="tsd-kind-icon">Service<wbr/>Context</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Signer" class="tsd-kind-icon">Signer</a></li><li class="tsd-kind-type-alias"><a href="modules.html#SolanaCluster" class="tsd-kind-icon">Solana<wbr/>Cluster</a></li><li class="tsd-kind-variable"><a href="modules.html#TagChain" class="tsd-kind-icon">Tag<wbr/>Chain</a></li><li class="tsd-kind-variable"><a href="modules.html#TagMintingAgent" class="tsd-kind-icon">Tag<wbr/>Minting<wbr/>Agent</a></li><li class="tsd-kind-variable"><a href="modules.html#TagMintingAgentVersion" class="tsd-kind-icon">Tag<wbr/>Minting<wbr/>Agent<wbr/>Version</a></li><li class="tsd-kind-variable"><a href="modules.html#TagSolanaCluster" class="tsd-kind-icon">Tag<wbr/>Solana<wbr/>Cluster</a></li><li class="tsd-kind-variable"><a href="modules.html#metadataSchema" class="tsd-kind-icon">metadata<wbr/>Schema</a></li><li class="tsd-kind-variable"><a href="modules.html#validateMetadata" class="tsd-kind-icon">validate<wbr/>Metadata</a></li><li class="tsd-kind-function"><a href="modules.html#MetaplexAuthWithSecretKey" class="tsd-kind-icon">Metaplex<wbr/>Auth<wbr/>With<wbr/>Secret<wbr/>Key</a></li><li class="tsd-kind-function"><a href="modules.html#MetaplexAuthWithSigner" class="tsd-kind-icon">Metaplex<wbr/>Auth<wbr/>With<wbr/>Signer</a></li><li class="tsd-kind-function"><a href="modules.html#ensureValidMetadata" class="tsd-kind-icon">ensure<wbr/>Valid<wbr/>Metadata</a></li><li class="tsd-kind-function"><a href="modules.html#keyDID" class="tsd-kind-icon">keyDID</a></li><li class="tsd-kind-function"><a href="modules.html#loadNFTFromFilesystem" class="tsd-kind-icon">loadNFTFrom<wbr/>Filesystem</a></li><li class="tsd-kind-function"><a href="modules.html#makeMetaplexUploadToken" class="tsd-kind-icon">make<wbr/>Metaplex<wbr/>Upload<wbr/>Token</a></li><li class="tsd-kind-function"><a href="modules.html#prepareMetaplexNFT" class="tsd-kind-icon">prepare<wbr/>MetaplexNFT</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>